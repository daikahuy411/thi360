<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--------------------------------------------------------------------------->
<!--                           INTRODUCTION                                

 The Code Project article submission template (HTML version)

Using this template will help us post your article sooner. To use, just 
follow the 3 easy steps below:
 
     1. Fill in the article description details
     2. Add links to your images and downloads
     3. Include the main article text

That's all there is to it! All formatting will be done by our submission
scripts and style sheets. 

-->
<!--------------------------------------------------------------------------->
<!--                        IGNORE THIS SECTION                            -->
<html>
  <head>
    <title>The Code Project</title>
    <style>
      BODY,
      P,
      TD {
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 10pt;
      }
      H2,
      H3,
      H4,
      H5 {
        color: #ff9900;
        font-weight: bold;
      }
      H2 {
        font-size: 13pt;
      }
      H3 {
        font-size: 12pt;
      }
      H4 {
        font-size: 10pt;
        color: black;
      }
      PRE {
        background-color: #fbedbb;
        font-family: 'Courier New', Courier, mono;
        white-space: pre;
      }
      CODE {
        color: #990000;
        font-family: 'Courier New', Courier, mono;
      }
    </style>
    <link rel="stylesheet" type="text/css" href="http://www.codeproject.com/App_Themes/NetCommunity/CodeProject.css" />
  </head>
  <body bgcolor="#FFFFFF" color="#000000">
    <!--------------------------------------------------------------------------->

    <!-------------------------------     STEP 1      --------------------------->
    <!--  Fill in the details (CodeProject will reformat this section for you) -->

    <pre>
Title:       Draw connecting lines between items on a web page (Mozilla/IE)
Author:      James Love
Email:       solanapraxis@hotmail.com
Member ID:   6508647
Language:    JavaScript/HTML
Platform:    Windows, Internet Explorer 6+ / FireFox 2+
Technology:  JavaScript/DHTML
Level:       Beginner
Description: Working GUI allows user to "connect" items shown on a web application. Lines are drawn showing connections. A routine is offered that could save the connections in a database.
Section      Web Development
SubSection   Client Side Scripting
License:     
</pre
    >

    <!-------------------------------     STEP 2      --------------------------->
    <!--  Include download and sample image information.                       -->

    <ul class="download">
      <li><a href="drawConnectorsJL.zip">Download source - 3.8 Kb</a></li>
    </ul>

    <p><img src="drawConnectors.gif" alt="Sample Image" width="553" height="99" /></p>

    <!-------------------------------     STEP 3      --------------------------->

    <!--  Add the article text. Please use simple formatting (<h2>, <p> etc)   -->

    <h2>Introduction</h2>

    <p>
      This simple HTML page displays two columns of items, representing items in two tables in a database. The interface
      allows the user to "connect" these items in a 1-to-1 format by clicking them. A line is drawn between connected
      items, giving the user a graphic representation of their connections. Connections can also be removed by the user
      clicking a connected item again.
    </p>

    <h2>Background</h2>

    <p>
      This is an extension of a line-drawing method described by Doga Arinir in his article:
      http://www.codeproject.com/KB/scripting/javascriptlinedrawing.aspx
    </p>

    <h2>Using the Code</h2>

    <p>
      Everything is in a single HTML file (except the server-side save function, not included). When the user clicks an
      item in either table, the item is prepared to be connected. If the user then clicks an unconnected item from the
      other table, a connection is made. A line is drawn to show the connection. The connections are made by the
      following two functions.
    </p>

    <pre lang="jscript">
function setSource(oSrc) {
	//if another source was clicked first, unhilite it
	if (oSource != null) {
		if (oSource.className == "treeItem_hi") {
			oSource.className = "treeItem";
		}
		oSource = null;
	}
	//if this source is already set, clear its line and its target
	if (oSrc.className == "treeItem_set") {
		//this source was already set; clear
		clearElementSetting(oSrc.id);
	}
	oSrc.className = "treeItem_hi";
	oSource = oSrc;
	if (oTarget != null) {
		drawLine();		//line is drawn from current Source to current Target
		oSource = null;
		oTarget = null;
	}
}
function setTarget(oTar) {
	if (oTarget != null) {
		if (oTarget.className == "treeItem_hi") {
			oTarget.className = "treeItem";
		}
		oTarget = null;
	}
	if (oTar.className == "treeItem_set") {
		//this target already has a source; clear
		clearElementSetting(oTar.id);
	}
	oTar.className = "treeItem_hi";
	oTarget = oTar;
	if (oSource != null) {
		drawLine();		//line is drawn from current Source to current Target
		oSource = null;
		oTarget = null;
	}
}
</pre
    >

    <p>
      When an item is clicked, it clears any previously clicked (but not connected) item in its table. Any existing
      connections to the clicked item are removed. Then if an item was already clicked in the other table, it connects
      them. By design, if a connection is made to an item that is already connected, the new connection overrides the
      old one.
    </p>

    <p>In the HTML, onClick event handlers for the source and target items call the functions respectively:</p>
    <pre lang="html">
	<span id="Item0_0" class="treeItem" onclick="setSource(this)">Source Item One</span>

	<span id="Item1_0" class="treeItem" onclick="setTarget(this)">Target Item 1</span>
</pre>

    <h2>Points of Interest</h2>

    <p>
      The only "tricky" part of this project was getting connector lines to disappear when their source or target items
      were clicked again. Since this model is a 1-to-1 data relationship, multiple connections to a single item are not
      allowed. (You could allow multiple connections with a little more work on the "Package Up" routine). To accomplish
      this, I've added two custom attributes to each "line segment" DIV: <code>mySrc</code> and <code>myTar</code>. When
      an element on the page is clicked, the code checks to see if it was already connected (by checking its current
      style definition). If it was, the "canvas" where all the lines are contained is searched for the line that
      connected that item. The line is then removed from the document.
    </p>

    <p>
      Once the user has finished connecting the items they want connected, they click the "Package Up" button. The
      function called simply counts all the unique lines (by checking their <code>mySrc</code> attributes), and calls a
      save routine.
    </p>

    <h2>Further Work</h2>

    <p>
      I have not yet addressed pre-populating the page with the connections currently stored in the database. This would
      be necessary if this tool was used to edit existing cross-reference connections between items.

      <!-------------------------------    That's it!   --------------------------->
    </p>
  </body>
</html>
